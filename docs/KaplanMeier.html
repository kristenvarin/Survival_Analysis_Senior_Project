<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Survival Analysis Senior Project - 2&nbsp; Kaplan Meier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./HazardAnalysis.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./KaplanMeier.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kaplan Meier</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Survival Analysis Senior Project</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./KaplanMeier.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kaplan Meier</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HazardAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Cox Proportional Hazards Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#kaplan-meier-survival-estimate" id="toc-kaplan-meier-survival-estimate" class="nav-link active" data-scroll-target="#kaplan-meier-survival-estimate"><span class="header-section-number">2.1</span> Kaplan Meier Survival Estimate</a></li>
  <li><a href="#kaplan-meier-curve-and-descriptive-statistics" id="toc-kaplan-meier-curve-and-descriptive-statistics" class="nav-link" data-scroll-target="#kaplan-meier-curve-and-descriptive-statistics"><span class="header-section-number">2.2</span> Kaplan Meier Curve and Descriptive Statistics</a></li>
  <li><a href="#kaplan-meier-in-r" id="toc-kaplan-meier-in-r" class="nav-link" data-scroll-target="#kaplan-meier-in-r"><span class="header-section-number">2.3</span> Kaplan Meier in R</a></li>
  <li><a href="#log-rank-test" id="toc-log-rank-test" class="nav-link" data-scroll-target="#log-rank-test"><span class="header-section-number">2.4</span> Log-Rank Test</a></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study"><span class="header-section-number">2.5</span> Case Study</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">2.6</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kaplan Meier</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="kaplan-meier-survival-estimate" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="kaplan-meier-survival-estimate"><span class="header-section-number">2.1</span> Kaplan Meier Survival Estimate</h2>
<p>The Kaplan Meier survival estimate is how survival probabilities can be calculated while factoring in censored times. The Kaplan Meier survival estimate is used to calculate probability of survival at a given time where <span class="math inline">\(S(t_j)\)</span> is the probability of being alive at time <span class="math inline">\(t_j\)</span>, <span class="math inline">\(S(t_{j-1})\)</span> is the probability of being alive at <span class="math inline">\(t_{j-1}\)</span>, <span class="math inline">\(n_j\)</span> is the number of patients alive just before <span class="math inline">\(t_j\)</span>, <span class="math inline">\(d_j\)</span> is the number of events at <span class="math inline">\(t_j\)</span>, and <span class="math inline">\(j\)</span> is the time interval of interest. The equation is <span class="math inline">\(S(t_j)=S(t_{j-1})(1-\frac{d_j}{n_j})\)</span> (<span class="citation" data-cites="clark03">Clark (<a href="#ref-clark03" role="doc-biblioref">2003</a>)</span>). The equation essentially divides the surviving individuals by the individuals at risk, similar to the previous calculations shown. However, Kaplan Meier curves adjust for right-censored times by dropping observations from the total number of individuals at risk, <span class="math inline">\(n_j\)</span>, after their censored time has been reached. This adjustment prevents overestimating the survival probability because it no longer assumes censored individuals are still alive or and at risk (<span class="citation" data-cites="goel10">Goel (<a href="#ref-goel10" role="doc-biblioref">2010</a>)</span>).</p>
</section>
<section id="kaplan-meier-curve-and-descriptive-statistics" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="kaplan-meier-curve-and-descriptive-statistics"><span class="header-section-number">2.2</span> Kaplan Meier Curve and Descriptive Statistics</h2>
<p>The Kaplan Meier curve is a graphical representation of survival analysis. Similar to the survival probabilities discussed previously, the Kaplan Meier curve shows the relationships between time, which is typically plotted on the x-axis, and probability of survival, which is typically on the y-axis. The curve always ranges from 0 to 1 and is right skewed. Useful summary statistics for a Kaplan Meier Survival curve include confidence intervals and the median. A 95% confidence interval for each point can be found by using the formula <span class="math inline">\(S_t ± 1.96 * SE(S_t)\)</span>. The median value is typically reported rather than the mean because mean survival time cannot be reported reliably for those who have not experienced the outcome of interest yet. The median can be found by finding the time when probability of survival is equal to 0.5. Thus, the median can only be reported when at least half of the participants experienced the outcome of interest during the study (<span class="citation" data-cites="rao23">Rao (<a href="#ref-rao23" role="doc-biblioref">2023</a>)</span>).</p>
</section>
<section id="kaplan-meier-in-r" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="kaplan-meier-in-r"><span class="header-section-number">2.3</span> Kaplan Meier in R</h2>
<p>Luckily, modern software makes these calculations easy and fast, as well as plotting them with confidence intervals and risk tables. A new data set with censored times will be created to demonstrate this process. To do this, a 0 will be recorded for some individuals at times before t = 10. <a href="#tbl-censor">Table&nbsp;<span>2.1</span></a> shows this data set’s structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsurvfit)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data set</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#id &lt;- c(5, 5, 7, 7, 8, 8, 9, 9, 1, 1)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>status <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>censor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(id, time, status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>censor <span class="sc">%&gt;%</span> <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Example Data Set with Censored Times"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">id =</span> <span class="st">"ID"</span>, <span class="at">time =</span> <span class="st">"Time"</span>, <span class="at">status =</span> <span class="st">"Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="st">"Table 3"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-censor" class="anchored">

<div id="lkzgftzikj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lkzgftzikj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lkzgftzikj thead, #lkzgftzikj tbody, #lkzgftzikj tfoot, #lkzgftzikj tr, #lkzgftzikj td, #lkzgftzikj th {
  border-style: none;
}

#lkzgftzikj p {
  margin: 0;
  padding: 0;
}

#lkzgftzikj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lkzgftzikj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lkzgftzikj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lkzgftzikj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lkzgftzikj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkzgftzikj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkzgftzikj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkzgftzikj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lkzgftzikj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lkzgftzikj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lkzgftzikj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lkzgftzikj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lkzgftzikj .gt_spanner_row {
  border-bottom-style: hidden;
}

#lkzgftzikj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lkzgftzikj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lkzgftzikj .gt_from_md > :first-child {
  margin-top: 0;
}

#lkzgftzikj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lkzgftzikj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lkzgftzikj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lkzgftzikj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lkzgftzikj .gt_row_group_first td {
  border-top-width: 2px;
}

#lkzgftzikj .gt_row_group_first th {
  border-top-width: 2px;
}

#lkzgftzikj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkzgftzikj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lkzgftzikj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lkzgftzikj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkzgftzikj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkzgftzikj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lkzgftzikj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lkzgftzikj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lkzgftzikj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkzgftzikj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkzgftzikj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkzgftzikj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkzgftzikj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkzgftzikj .gt_left {
  text-align: left;
}

#lkzgftzikj .gt_center {
  text-align: center;
}

#lkzgftzikj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lkzgftzikj .gt_font_normal {
  font-weight: normal;
}

#lkzgftzikj .gt_font_bold {
  font-weight: bold;
}

#lkzgftzikj .gt_font_italic {
  font-style: italic;
}

#lkzgftzikj .gt_super {
  font-size: 65%;
}

#lkzgftzikj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lkzgftzikj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lkzgftzikj .gt_indent_1 {
  text-indent: 5px;
}

#lkzgftzikj .gt_indent_2 {
  text-indent: 10px;
}

#lkzgftzikj .gt_indent_3 {
  text-indent: 15px;
}

#lkzgftzikj .gt_indent_4 {
  text-indent: 20px;
}

#lkzgftzikj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption>Table&nbsp;2.1:  <p>Example Data Set with Censored Times</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Time">Time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Status">Status</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="id" class="gt_row gt_right">1</td>
<td headers="time" class="gt_row gt_right">1</td>
<td headers="status" class="gt_row gt_right">1</td></tr>
    <tr><td headers="id" class="gt_row gt_right">2</td>
<td headers="time" class="gt_row gt_right">2</td>
<td headers="status" class="gt_row gt_right">1</td></tr>
    <tr><td headers="id" class="gt_row gt_right">3</td>
<td headers="time" class="gt_row gt_right">10</td>
<td headers="status" class="gt_row gt_right">0</td></tr>
    <tr><td headers="id" class="gt_row gt_right">4</td>
<td headers="time" class="gt_row gt_right">4</td>
<td headers="status" class="gt_row gt_right">0</td></tr>
    <tr><td headers="id" class="gt_row gt_right">5</td>
<td headers="time" class="gt_row gt_right">5</td>
<td headers="status" class="gt_row gt_right">1</td></tr>
    <tr><td headers="id" class="gt_row gt_right">6</td>
<td headers="time" class="gt_row gt_right">6</td>
<td headers="status" class="gt_row gt_right">0</td></tr>
    <tr><td headers="id" class="gt_row gt_right">7</td>
<td headers="time" class="gt_row gt_right">10</td>
<td headers="status" class="gt_row gt_right">0</td></tr>
    <tr><td headers="id" class="gt_row gt_right">8</td>
<td headers="time" class="gt_row gt_right">8</td>
<td headers="status" class="gt_row gt_right">1</td></tr>
    <tr><td headers="id" class="gt_row gt_right">9</td>
<td headers="time" class="gt_row gt_right">9</td>
<td headers="status" class="gt_row gt_right">1</td></tr>
    <tr><td headers="id" class="gt_row gt_right">10</td>
<td headers="time" class="gt_row gt_right">10</td>
<td headers="status" class="gt_row gt_right">0</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="3">Table 3</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
</div>
<p>The <code>survival</code> package in <code>R</code> has a function called <code>Surv()</code> that takes input data and creates a response object recording survival time for each observation. The function takes in the time variable and the status variable. The function takes into account right censoring as well, marking censored times with a <span class="math inline">\(+\)</span> symbol in the object created (<span class="citation" data-cites="zabor23">Zabor (<a href="#ref-zabor23" role="doc-biblioref">2023</a>)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the time of event or censored time for each observation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">Surv</span>(censor<span class="sc">$</span>time, censor<span class="sc">$</span>status)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>times</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1   2  10+  4+  5   6+ 10+  8   9  10+</code></pre>
</div>
</div>
<p>The <code>survfit()</code> function can be used to calculate the Kaplan Meier survival estimate for each time that a new event occurs. The function takes in the response object created by the <code>Surv()</code> function in order to drop censored observations from the regression. We use ~ 1 because we are not including predictor variables in the model. The function returns a survival object that can be used to plot the Kaplan Meier curve and calculate summary statistics. The <code>time</code> variable in the object created by the <code>survfit()</code> function shows the time of each event, and the <code>surv</code> variable shows the survival probability for the remaining individuals after each event occurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survival object</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(times <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> censor)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View the survival time for each time an event occurs</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>s1<span class="sc">$</span>time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  4  5  6  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View survival probability for remaining individuals after each event occurs </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(s1<span class="sc">$</span>surv, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.90 0.80 0.80 0.69 0.69 0.55 0.41 0.41</code></pre>
</div>
</div>
<p>The <code>ggsurvfit</code> package can be used to plot the Kaplan Meier curve for this data using the previously created <code>s1</code> object. <a href="#fig-survcurv">Figure&nbsp;<span>2.1</span></a> shows the Kaplan Meier curve for predicting the event. The risk table shows the number of individuals at risk at each time point and the number of events that occurred at each time point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Kaplan Meier Survival Curve"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-survcurv" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="KaplanMeier_files/figure-html/fig-survcurv-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Kaplan Meier Survival Curve</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="log-rank-test" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="log-rank-test"><span class="header-section-number">2.4</span> Log-Rank Test</h2>
<p>One of the most common applications of survival analysis and Kaplan Meier curves is for comparing survival times between two groups. One example of when this might be useful is if a study is comparing survival after two different treatment plans. A data set with two groups will be created to demonstrate this process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data set</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>status <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span> ,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>surv2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(time, status, group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To run analysis, the statistical test called the Log-Rank Test can be used to test the null hypothesis that there is no difference between the survival estimates of two groups at any point in time (<span class="citation" data-cites="rich10">Rich (<a href="#ref-rich10" role="doc-biblioref">2010</a>)</span>). The test is conducted by comparing the observed number of event with an estimated number of events for each group at each time. To model this, we need to record some values of interest from our existing data. The first, <span class="math inline">\(n1t\)</span>, represents the number of people alive and still in the study, or at risk, at time t in group 1. Similarly, <span class="math inline">\(n2t\)</span> is the number at risk in group 2 at time t. <span class="math inline">\(nt\)</span> is the sum of these two values at time t, representing the total number of people at risk in the study at time t. <span class="math inline">\(o1t\)</span> is the number of observed events occurring at time t in group 1, <span class="math inline">\(o2t\)</span> is observed events occurring at time t in group 2, and <span class="math inline">\(ot\)</span> is the total observed events across both groups at time t. To calculate expected number of events, the assumption that the two curves are identical is used. The expected number of events at a time t is for group i calculated by the formula <span class="math inline">\(E_{it} = \frac{N_{it} \times O_{t}}{N_{t}}\)</span>, where <span class="math inline">\(N_{it}\)</span> is the observed number of events in group i at time t, <span class="math inline">\(O_{t}\)</span> is the total number of events in all groups at time t, and <span class="math inline">\(N_{t}\)</span> is the total number observations at risk in all groups at time t (<span class="citation" data-cites="sullivan16">Sullivan (<a href="#ref-sullivan16" role="doc-biblioref">2016</a>)</span>). <a href="#tbl-logrank">Table&nbsp;<span>2.2</span></a> shows the creation of all of these values, where <span class="math inline">\(e1t\)</span> is the expected number of events at time t in group 1, <span class="math inline">\(e2t\)</span> is the expected number of events at time t in group 2, and <span class="math inline">\(et\)</span> is the total expected number of events across both groups at time t. Cumulative sums are also calculated for each of these values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>N1t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>N2t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>O1t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>O2t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>log_rank <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Time, N1t, N2t, O1t, O2t)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Totals</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>Nt <span class="ot">&lt;-</span> log_rank<span class="sc">$</span>N1t <span class="sc">+</span> log_rank<span class="sc">$</span>N2t</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>Ot <span class="ot">&lt;-</span> log_rank<span class="sc">$</span>O1t <span class="sc">+</span> log_rank<span class="sc">$</span>O2t</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>E1t <span class="ot">&lt;-</span> (log_rank<span class="sc">$</span>N1t <span class="sc">*</span> log_rank<span class="sc">$</span>Ot) <span class="sc">/</span> log_rank<span class="sc">$</span>Nt</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>E2t <span class="ot">&lt;-</span> (log_rank<span class="sc">$</span>N2t <span class="sc">*</span> log_rank<span class="sc">$</span>Ot) <span class="sc">/</span> log_rank<span class="sc">$</span>Nt</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(log_rank, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Values Needed to Calculate Chi-Square Statistic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">Time =</span> <span class="st">"Time"</span>, <span class="at">N1t =</span> <span class="st">"Number at Risk in Group 1"</span>, <span class="at">N2t =</span> <span class="st">"Number at Risk in Group 2"</span>, <span class="at">Nt =</span> <span class="st">"Total Number at Risk"</span>, <span class="at">O1t =</span> <span class="st">"Observed Events in Group 1"</span>, <span class="at">O2t =</span> <span class="st">"Observed Events in Group 2"</span>, <span class="at">Ot =</span> <span class="st">"Total Observed Events"</span>, <span class="at">E1t =</span> <span class="st">"Expected Events in Group 1"</span>, <span class="at">E2t =</span> <span class="st">"Expected Events in Group 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-logrank" class="anchored">

<div id="xtozdtewpv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xtozdtewpv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xtozdtewpv thead, #xtozdtewpv tbody, #xtozdtewpv tfoot, #xtozdtewpv tr, #xtozdtewpv td, #xtozdtewpv th {
  border-style: none;
}

#xtozdtewpv p {
  margin: 0;
  padding: 0;
}

#xtozdtewpv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xtozdtewpv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xtozdtewpv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xtozdtewpv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xtozdtewpv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtozdtewpv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtozdtewpv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtozdtewpv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xtozdtewpv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xtozdtewpv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xtozdtewpv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xtozdtewpv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xtozdtewpv .gt_spanner_row {
  border-bottom-style: hidden;
}

#xtozdtewpv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xtozdtewpv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xtozdtewpv .gt_from_md > :first-child {
  margin-top: 0;
}

#xtozdtewpv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xtozdtewpv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xtozdtewpv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xtozdtewpv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xtozdtewpv .gt_row_group_first td {
  border-top-width: 2px;
}

#xtozdtewpv .gt_row_group_first th {
  border-top-width: 2px;
}

#xtozdtewpv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtozdtewpv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xtozdtewpv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xtozdtewpv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtozdtewpv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtozdtewpv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xtozdtewpv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xtozdtewpv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xtozdtewpv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtozdtewpv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtozdtewpv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtozdtewpv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtozdtewpv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtozdtewpv .gt_left {
  text-align: left;
}

#xtozdtewpv .gt_center {
  text-align: center;
}

#xtozdtewpv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xtozdtewpv .gt_font_normal {
  font-weight: normal;
}

#xtozdtewpv .gt_font_bold {
  font-weight: bold;
}

#xtozdtewpv .gt_font_italic {
  font-style: italic;
}

#xtozdtewpv .gt_super {
  font-size: 65%;
}

#xtozdtewpv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xtozdtewpv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xtozdtewpv .gt_indent_1 {
  text-indent: 5px;
}

#xtozdtewpv .gt_indent_2 {
  text-indent: 10px;
}

#xtozdtewpv .gt_indent_3 {
  text-indent: 15px;
}

#xtozdtewpv .gt_indent_4 {
  text-indent: 20px;
}

#xtozdtewpv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2.2:  <p>Calculation of Log-Rank Test Statistic</p> </caption>
  <thead>
    <tr class="gt_heading">
      <td colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Values Needed to Calculate Chi-Square Statistic</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Time">Time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number at Risk in Group 1">Number at Risk in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number at Risk in Group 2">Number at Risk in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Observed Events in Group 1">Observed Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Observed Events in Group 2">Observed Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Total Number at Risk">Total Number at Risk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Total Observed Events">Total Observed Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected Events in Group 1">Expected Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected Events in Group 2">Expected Events in Group 2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Time" class="gt_row gt_right">1</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">5</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">10</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.50</td>
<td headers="E2t" class="gt_row gt_right">0.50</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">3</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">4</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">9</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.56</td>
<td headers="E2t" class="gt_row gt_right">0.44</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">4</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">3</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">8</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">5</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">2</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">7</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">6</td>
<td headers="N1t" class="gt_row gt_right">4</td>
<td headers="N2t" class="gt_row gt_right">2</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">6</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.67</td>
<td headers="E2t" class="gt_row gt_right">0.33</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">7</td>
<td headers="N1t" class="gt_row gt_right">4</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">1</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">5</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.80</td>
<td headers="E2t" class="gt_row gt_right">0.20</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">8</td>
<td headers="N1t" class="gt_row gt_right">3</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">1</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">4</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.75</td>
<td headers="E2t" class="gt_row gt_right">0.25</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">10</td>
<td headers="N1t" class="gt_row gt_right">1</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">2</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>To test the null hypothesis that there is no difference between the survival estimates of two groups at any point in time, a test statistics is needed. For the Log-Rank test, a Chi-Square test statistic is used because the data follows a Chi-Square curve rather than a normal distribution. The Chi-Square test statistic is calculated by the formula <span class="math inline">\(X^2 = \sum_{i=1}^k \frac{(\sum{O_{it}} - \sum{E_{it}})^2}{\sum{Vi}}\)</span>, where <span class="math inline">\(\sum_{0}^T{O_{it}}\)</span> is the sum of the observed number of events in group i over the entire time interval and <span class="math inline">\(\sum_{0}^T{E_{it}}\)</span> is the sum of the expected number of events in group i over the entire time interval. The difference of the sums of these two values are divided by the sum of the variance. The variance for group 1 at time t is calculated by the formula <span class="math inline">\(V_{1t} = \frac{N_{1t} \times N_{2t} \times O_{t} \times (N_{t} - O_{t})}{N_{t}^2 \times (N_{t} - 1)}\)</span> (<span class="citation" data-cites="collet">Collet (<a href="#ref-collet" role="doc-biblioref">2003</a>)</span>). The variance for group 2 is calculated similarly, and the total variance is calculated by the formula <span class="math inline">\(V_{t} = V_{1t} + V_{2t}\)</span>. <a href="#tbl-logrank2">Table&nbsp;<span>2.3</span></a> shows the calculation of the Chi-Square test statistic for the data set. In the table, <span class="math inline">\(V1t\)</span> is the variance of the number of events at time t in group 1, <span class="math inline">\(V2t\)</span> is the variance of the number of events at time t in group 2, <span class="math inline">\(Vt\)</span> is the total variance of the number of events across both groups at time t, <span class="math inline">\(sum_{Vt}\)</span> is the cumulative sum of the total variance across all times, and <span class="math inline">\(X2\)</span> is the Chi-Square test statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>V1t <span class="ot">&lt;-</span> (log_rank<span class="sc">$</span>N1t <span class="sc">*</span> log_rank<span class="sc">$</span>N2t <span class="sc">*</span> log_rank<span class="sc">$</span>Ot <span class="sc">*</span> (log_rank<span class="sc">$</span>Nt <span class="sc">-</span> log_rank<span class="sc">$</span>Ot)) <span class="sc">/</span> (log_rank<span class="sc">$</span>Nt<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (log_rank<span class="sc">$</span>Nt <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>log_rank<span class="sc">$</span>V2t <span class="ot">&lt;-</span> (log_rank<span class="sc">$</span>N1t <span class="sc">*</span> log_rank<span class="sc">$</span>N2t <span class="sc">*</span> log_rank<span class="sc">$</span>Ot <span class="sc">*</span> (log_rank<span class="sc">$</span>Nt <span class="sc">-</span> log_rank<span class="sc">$</span>Ot)) <span class="sc">/</span> (log_rank<span class="sc">$</span>Nt<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (log_rank<span class="sc">$</span>Nt <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(log_rank, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Calculation of Variance"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">Time =</span> <span class="st">"Time"</span>, <span class="at">N1t =</span> <span class="st">"Number at Risk in Group 1"</span>, <span class="at">N2t =</span> <span class="st">"Number at Risk in Group 2"</span>, <span class="at">Nt =</span> <span class="st">"Total Number at Risk"</span>, <span class="at">O1t =</span> <span class="st">"Observed Events in Group 1"</span>, <span class="at">O2t =</span> <span class="st">"Observed Events in Group 2"</span>, <span class="at">Ot =</span> <span class="st">"Total Observed Events"</span>, <span class="at">E1t =</span> <span class="st">"Expected Events in Group 1"</span>, <span class="at">E2t =</span> <span class="st">"Expected Events in Group 2"</span>, <span class="at">V1t =</span> <span class="st">"Variance of Number of Events in Group 1"</span>, <span class="at">V2t =</span> <span class="st">"Variance of Number of Events in Group 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-logrank2" class="anchored">

<div id="prcfdjhzho" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#prcfdjhzho table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#prcfdjhzho thead, #prcfdjhzho tbody, #prcfdjhzho tfoot, #prcfdjhzho tr, #prcfdjhzho td, #prcfdjhzho th {
  border-style: none;
}

#prcfdjhzho p {
  margin: 0;
  padding: 0;
}

#prcfdjhzho .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#prcfdjhzho .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#prcfdjhzho .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#prcfdjhzho .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#prcfdjhzho .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prcfdjhzho .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prcfdjhzho .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prcfdjhzho .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#prcfdjhzho .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#prcfdjhzho .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#prcfdjhzho .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#prcfdjhzho .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#prcfdjhzho .gt_spanner_row {
  border-bottom-style: hidden;
}

#prcfdjhzho .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#prcfdjhzho .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#prcfdjhzho .gt_from_md > :first-child {
  margin-top: 0;
}

#prcfdjhzho .gt_from_md > :last-child {
  margin-bottom: 0;
}

#prcfdjhzho .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#prcfdjhzho .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#prcfdjhzho .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#prcfdjhzho .gt_row_group_first td {
  border-top-width: 2px;
}

#prcfdjhzho .gt_row_group_first th {
  border-top-width: 2px;
}

#prcfdjhzho .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prcfdjhzho .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#prcfdjhzho .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#prcfdjhzho .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prcfdjhzho .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prcfdjhzho .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#prcfdjhzho .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#prcfdjhzho .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#prcfdjhzho .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prcfdjhzho .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prcfdjhzho .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prcfdjhzho .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prcfdjhzho .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prcfdjhzho .gt_left {
  text-align: left;
}

#prcfdjhzho .gt_center {
  text-align: center;
}

#prcfdjhzho .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#prcfdjhzho .gt_font_normal {
  font-weight: normal;
}

#prcfdjhzho .gt_font_bold {
  font-weight: bold;
}

#prcfdjhzho .gt_font_italic {
  font-style: italic;
}

#prcfdjhzho .gt_super {
  font-size: 65%;
}

#prcfdjhzho .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#prcfdjhzho .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#prcfdjhzho .gt_indent_1 {
  text-indent: 5px;
}

#prcfdjhzho .gt_indent_2 {
  text-indent: 10px;
}

#prcfdjhzho .gt_indent_3 {
  text-indent: 15px;
}

#prcfdjhzho .gt_indent_4 {
  text-indent: 20px;
}

#prcfdjhzho .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2.3:  <p>Calculation of Variance</p> </caption>
  <thead>
    <tr class="gt_heading">
      <td colspan="11" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Calculation of Variance</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Time">Time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number at Risk in Group 1">Number at Risk in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number at Risk in Group 2">Number at Risk in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Observed Events in Group 1">Observed Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Observed Events in Group 2">Observed Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Total Number at Risk">Total Number at Risk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Total Observed Events">Total Observed Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected Events in Group 1">Expected Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected Events in Group 2">Expected Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Variance of Number of Events in Group 1">Variance of Number of Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Variance of Number of Events in Group 2">Variance of Number of Events in Group 2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Time" class="gt_row gt_right">1</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">5</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">10</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.50</td>
<td headers="E2t" class="gt_row gt_right">0.50</td>
<td headers="V1t" class="gt_row gt_right">0.25</td>
<td headers="V2t" class="gt_row gt_right">0.25</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">3</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">4</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">9</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.56</td>
<td headers="E2t" class="gt_row gt_right">0.44</td>
<td headers="V1t" class="gt_row gt_right">0.25</td>
<td headers="V2t" class="gt_row gt_right">0.25</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">4</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">3</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">8</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td>
<td headers="V1t" class="gt_row gt_right">0.00</td>
<td headers="V2t" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">5</td>
<td headers="N1t" class="gt_row gt_right">5</td>
<td headers="N2t" class="gt_row gt_right">2</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">7</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td>
<td headers="V1t" class="gt_row gt_right">0.00</td>
<td headers="V2t" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">6</td>
<td headers="N1t" class="gt_row gt_right">4</td>
<td headers="N2t" class="gt_row gt_right">2</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">1</td>
<td headers="Nt" class="gt_row gt_right">6</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.67</td>
<td headers="E2t" class="gt_row gt_right">0.33</td>
<td headers="V1t" class="gt_row gt_right">0.22</td>
<td headers="V2t" class="gt_row gt_right">0.22</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">7</td>
<td headers="N1t" class="gt_row gt_right">4</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">1</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">5</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.80</td>
<td headers="E2t" class="gt_row gt_right">0.20</td>
<td headers="V1t" class="gt_row gt_right">0.16</td>
<td headers="V2t" class="gt_row gt_right">0.16</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">8</td>
<td headers="N1t" class="gt_row gt_right">3</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">1</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">4</td>
<td headers="Ot" class="gt_row gt_right">1</td>
<td headers="E1t" class="gt_row gt_right">0.75</td>
<td headers="E2t" class="gt_row gt_right">0.25</td>
<td headers="V1t" class="gt_row gt_right">0.19</td>
<td headers="V2t" class="gt_row gt_right">0.19</td></tr>
    <tr><td headers="Time" class="gt_row gt_right">10</td>
<td headers="N1t" class="gt_row gt_right">1</td>
<td headers="N2t" class="gt_row gt_right">1</td>
<td headers="O1t" class="gt_row gt_right">0</td>
<td headers="O2t" class="gt_row gt_right">0</td>
<td headers="Nt" class="gt_row gt_right">2</td>
<td headers="Ot" class="gt_row gt_right">0</td>
<td headers="E1t" class="gt_row gt_right">0.00</td>
<td headers="E2t" class="gt_row gt_right">0.00</td>
<td headers="V1t" class="gt_row gt_right">0.00</td>
<td headers="V2t" class="gt_row gt_right">0.00</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>For group 1 at time 1, we would calculate <span class="math inline">\(E_{1t} = \frac{5 \times 1}{10} = 0.50\)</span> and for group 2 at time 1, <span class="math inline">\(E_{2t} = \frac{5 \times 1}{10} = 0.50\)</span>. We would repeat for each group at each time and then sum the values to get <span class="math inline">\(\sum_{t=1}^t{E_{i}}\)</span> for each group. For group 1, <span class="math inline">\(\sum_{t=1}^t{E_{1}} = 0.50 + 0.56 + 0 + 0 + 0.67 + 0.80 + 0.75 + 0 = 3.27\)</span> and for group 2, <span class="math inline">\(\sum_{t=0}^t{E_{2}} = 0.50 + 0.44 + 0 + 0 + 0.33 + 0.20 + 0.25 + 0 = 1.73\)</span>. The sum of the observed events for group 1 is 2 and for group 2 is 3. For group 1 at time 1, we would calculate <span class="math inline">\(V_1t = \frac{5 \times 5 \times 1 \times (10-1)}{10^2 \times (10-1)} = 0.25\)</span> <a href="#tbl-chi-square">Table&nbsp;<span>2.4</span></a> shows the rest of the variances calculated for both groups for the <code>surv2</code> data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sum_O1t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>O1t)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sum_O2t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>O2t)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sum_E1t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>E1t)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>sum_E2t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>E2t)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sum_V1t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>V1t)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>sum_V2t <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(log_rank<span class="sc">$</span>V2t)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table with each of the last values </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sum_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sum_O1t, sum_O2t, sum_E1t, sum_E2t, sum_V1t, sum_V2t)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the last row of summary statistics</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>sum_stats <span class="ot">&lt;-</span> sum_stats[<span class="fu">nrow</span>(sum_stats), ]</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>sum_stats<span class="sc">$</span>X2_group1 <span class="ot">&lt;-</span> ((sum_stats<span class="sc">$</span>sum_O1t <span class="sc">-</span> sum_stats<span class="sc">$</span>sum_E1t)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> sum_stats<span class="sc">$</span>sum_V1t)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>sum_stats<span class="sc">$</span>X2_group2 <span class="ot">&lt;-</span> ((sum_stats<span class="sc">$</span>sum_O2t <span class="sc">-</span> sum_stats<span class="sc">$</span>sum_E2t)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> sum_stats<span class="sc">$</span>sum_V2t)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(sum_stats, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Calculation of Chi Square Statistic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">sum_O1t =</span> <span class="st">"Sum of Observed Events in Group 1"</span>, <span class="at">sum_O2t =</span> <span class="st">"Sum of Observed Events in Group 2"</span>, <span class="at">sum_E1t =</span> <span class="st">"Sum of Expected Events in Group 1"</span>, <span class="at">sum_E2t =</span> <span class="st">"Sum of Expected Events in Group 2"</span>, <span class="at">sum_V1t =</span> <span class="st">"Sum of Variance of Number of Events in Group 1"</span>, <span class="at">sum_V2t =</span> <span class="st">"Sum of Variance of Number of Events in Group 2"</span>, <span class="at">X2_group1 =</span> <span class="st">"Chi Square Statistic for Group 1"</span>, <span class="at">X2_group2 =</span> <span class="st">"Chi Square Statistic for Group 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-chi-square" class="anchored">

<div id="jgclipresw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jgclipresw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jgclipresw thead, #jgclipresw tbody, #jgclipresw tfoot, #jgclipresw tr, #jgclipresw td, #jgclipresw th {
  border-style: none;
}

#jgclipresw p {
  margin: 0;
  padding: 0;
}

#jgclipresw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jgclipresw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jgclipresw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jgclipresw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jgclipresw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgclipresw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgclipresw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgclipresw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jgclipresw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jgclipresw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jgclipresw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jgclipresw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jgclipresw .gt_spanner_row {
  border-bottom-style: hidden;
}

#jgclipresw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jgclipresw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jgclipresw .gt_from_md > :first-child {
  margin-top: 0;
}

#jgclipresw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jgclipresw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jgclipresw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jgclipresw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jgclipresw .gt_row_group_first td {
  border-top-width: 2px;
}

#jgclipresw .gt_row_group_first th {
  border-top-width: 2px;
}

#jgclipresw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgclipresw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jgclipresw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jgclipresw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgclipresw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgclipresw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jgclipresw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jgclipresw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jgclipresw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgclipresw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgclipresw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgclipresw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgclipresw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgclipresw .gt_left {
  text-align: left;
}

#jgclipresw .gt_center {
  text-align: center;
}

#jgclipresw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jgclipresw .gt_font_normal {
  font-weight: normal;
}

#jgclipresw .gt_font_bold {
  font-weight: bold;
}

#jgclipresw .gt_font_italic {
  font-style: italic;
}

#jgclipresw .gt_super {
  font-size: 65%;
}

#jgclipresw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jgclipresw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jgclipresw .gt_indent_1 {
  text-indent: 5px;
}

#jgclipresw .gt_indent_2 {
  text-indent: 10px;
}

#jgclipresw .gt_indent_3 {
  text-indent: 15px;
}

#jgclipresw .gt_indent_4 {
  text-indent: 20px;
}

#jgclipresw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2.4:  <p>Calculation of Chi Square Statistic</p> </caption>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Calculation of Chi Square Statistic</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Observed Events in Group 1">Sum of Observed Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Observed Events in Group 2">Sum of Observed Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Expected Events in Group 1">Sum of Expected Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Expected Events in Group 2">Sum of Expected Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Variance of Number of Events in Group 1">Sum of Variance of Number of Events in Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sum of Variance of Number of Events in Group 2">Sum of Variance of Number of Events in Group 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Chi Square Statistic for Group 1">Chi Square Statistic for Group 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Chi Square Statistic for Group 2">Chi Square Statistic for Group 2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sum_O1t" class="gt_row gt_right">2</td>
<td headers="sum_O2t" class="gt_row gt_right">3</td>
<td headers="sum_E1t" class="gt_row gt_right">3.27</td>
<td headers="sum_E2t" class="gt_row gt_right">1.73</td>
<td headers="sum_V1t" class="gt_row gt_right">1.07</td>
<td headers="sum_V2t" class="gt_row gt_right">1.07</td>
<td headers="X2_group1" class="gt_row gt_right">1.52</td>
<td headers="X2_group2" class="gt_row gt_right">1.52</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>With all of these values, we can calculate the Chi Square test statistic, <span class="math inline">\(X^2i = \frac{(\sum{O_{it}} - \sum{E_{it}})^2}{V_{it}}\)</span>. We get <span class="math inline">\(X^2group1 = \frac{(2 - 3.27)^2}{1.07} = 1.51\)</span> and <span class="math inline">\(X^2group1 = \frac{(3 - 1.73)^2}{1.07} = 1.51\)</span>. The test statistic can then be compared to a Chi-Square distribution with one k-1 degrees of freedom, with k being the number of groups. So, for this example, there is one degree of freedom. If the p-value is less than 0.05, then we can reject the null hypothesis that there is no difference between the survival estimates of the two groups (<span class="citation" data-cites="sullivan16">Sullivan (<a href="#ref-sullivan16" role="doc-biblioref">2016</a>)</span>).</p>
<p>Clearly, calculating the test statistic is very tedious, even for a data set with 10 observations. The <code>survdiff</code> function can be used to run a Log-Rank test in R, making it much easier to run the test. The function takes in the response object created by the <code>Surv()</code> function and the grouping variable (<span class="citation" data-cites="zabor23">Zabor (<a href="#ref-zabor23" role="doc-biblioref">2023</a>)</span>). It returns a Chi-Square statistic and a p-value. We can see that the p-value is much higher than 0.05, indicating that we do not have evidence to reject the null hypothesis, and thus that there is no difference between the survival estimates of the two groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate times for events in this data set</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>times2 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(surv2<span class="sc">$</span>time, surv2<span class="sc">$</span>status)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a log rank test based on group variable</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>test_stat <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(times2 <span class="sc">~</span> group, <span class="at">data =</span> surv2)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>test_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = times2 ~ group, data = surv2)

        N Observed Expected (O-E)^2/E (O-E)^2/V
group=1 5        2     3.27     0.495      1.52
group=2 5        3     1.73     0.937      1.52

 Chisq= 1.5  on 1 degrees of freedom, p= 0.2 </code></pre>
</div>
</div>
<p>The only adjustment needed for plotting the Kaplan Meier curves for two groups is to include the grouping variable while making the survival object using the <code>survfit</code> function (<span class="citation" data-cites="zabor23">Zabor (<a href="#ref-zabor23" role="doc-biblioref">2023</a>)</span>). The two survival curves are depicted in <a href="#fig-survcurv2">Figure&nbsp;<span>2.2</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survival object using group as a predictor</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> group, <span class="at">data =</span> surv2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the two curves</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Kaplan Meier Survival Curve by Group"</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-survcurv2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="KaplanMeier_files/figure-html/fig-survcurv2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Kaplan Meier Survival Curve by Group</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="case-study" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="case-study"><span class="header-section-number">2.5</span> Case Study</h2>
<p>The next example uses a data set with variables for predicting death in patients with cirrhosis, which is permanent scarring of the liver. The data set is from a clinical trial conducted by the Mayo Clinic from 1974 to 1984. The data set contains 424 primary biliary cirrhosis patients with 20 variables (<span class="citation" data-cites="fedesoriano">Fedesoriano (<a href="#ref-fedesoriano" role="doc-biblioref">2021</a>)</span>). To conduct survival analysis, the <code>Status</code> variable needs to be transformed into an indicator variable, labelled <code>event</code>, coded as a 1 representing death and 0 representing censored. The <code>N_Days</code> variable will be used for the time variable, indicating number of days since the beginning of the trial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cirrhosis <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/cirrhosis.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cirrhosis <span class="ot">&lt;-</span> cirrhosis <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">if_else</span>(Status <span class="sc">==</span> <span class="st">'D'</span>, <span class="dv">1</span>, <span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The main interest of this data is to explore the difference in survival time between patients taking the drug of interest, D-penicillamine, and those given a placebo. The variable <code>Drug</code> indicates which group the patient was in and will be used as the grouping variable for a Log-Rank Test. Below, we calculate a survival object for this data and then use the <code>survdiff</code> function to run a Log-Rank Test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate times and survival object</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>times3 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(cirrhosis<span class="sc">$</span>N_Days, cirrhosis<span class="sc">$</span>event)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(times3 <span class="sc">~</span> Drug, <span class="at">data =</span> cirrhosis)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a log rank test based on drug group</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(times3 <span class="sc">~</span> Drug, <span class="at">data =</span> cirrhosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = times3 ~ Drug, data = cirrhosis)

n=312, 106 observations deleted due to missingness.

                       N Observed Expected (O-E)^2/E (O-E)^2/V
Drug=D-penicillamine 158       65     63.2    0.0502     0.102
Drug=Placebo         154       60     61.8    0.0513     0.102

 Chisq= 0.1  on 1 degrees of freedom, p= 0.7 </code></pre>
</div>
</div>
<p>From the Log-Rank test, we see that the p-value is 0.7, which is mush larger than 0.05. This indicates that the test was not statistically significant at the five percent level. Thus, there was no significant difference between patient outcome between the two treatment groups. For patients with biliary cirrhosis, D-penicillamine is not an effective drug for preventing death.</p>
<p>We can again visualize the difference in survival curves in <a href="#fig-casestudy">Figure&nbsp;<span>2.3</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>s3 <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Kaplan Meier Survival Curve"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-casestudy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="KaplanMeier_files/figure-html/fig-casestudy-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2.3: Kaplan Meier Survival Curve Predicting Death from Cirrhosis</figcaption>
</figure>
</div>
</div>
</div>
<p>It is important to note the limitations of this analysis. The Kaplan Meier Curve is not a suitable fit for a complex, real-world data set such as the <code>cirrhosis</code> data. It is a nonparametric method of analysis, which means that it assumes no form of distribution and no additional factors influencing the outcome of interest. To create a Kaplan Meier curve and run the Log-Rank test, we ignored all other factors included int the data. In the next section, we will discuss other methods that can be used for survival analysis that can account for other factors.</p>
</section>
<section id="references" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="references"><span class="header-section-number">2.6</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-clark03" class="csl-entry" role="listitem">
Clark, Bradburn, T. G. 2003. <span>“Survival Analysis Part i: Basic Concepts and First Analyses.”</span> <em>British Journal of Cancer</em>, May. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2394262/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2394262/</a>.
</div>
<div id="ref-collet" class="csl-entry" role="listitem">
Collet, David. 2003. <em>Modelling Survival Data in Medical Research</em>. Chapman &amp; Hall/CRC.
</div>
<div id="ref-fedesoriano" class="csl-entry" role="listitem">
Fedesoriano. 2021. <span>“Cirrhosis Prediction Dataset.”</span> <a href="https://www.kaggle.com/datasets/fedesoriano/cirrhosis-prediction-dataset/data">www.kaggle.com/datasets/fedesoriano/cirrhosis-prediction-dataset/data</a>.
</div>
<div id="ref-goel10" class="csl-entry" role="listitem">
Goel, Khanna, M. K. 2010. <span>“Understanding Survival Analysis: Kaplan-Meier Estimate.”</span> <em>International Journal of Ayurveda Research</em>. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3059453">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3059453</a>.
</div>
<div id="ref-rao23" class="csl-entry" role="listitem">
Rao, &amp; Schoenfeld, S. R. 2023. <span>“Statistical Primer for Cardiovascular Research.”</span> <em>AHA Journals</em>. <a href="https://www.ahajournals.org/doi/pdf/10.1161/circulationaha.106.614859">https://www.ahajournals.org/doi/pdf/10.1161/circulationaha.106.614859</a>.
</div>
<div id="ref-rich10" class="csl-entry" role="listitem">
Rich, Neely, J. T. 2010. <span>“A Practical Guide to Understanding Kaplan-Meier Curves.”</span> <em>Otolaryngology–Head and Neck Surgery: Official Journal of American Academy of Otolaryngology-Head and Neck Surgery</em>. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3932959/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3932959/</a>.
</div>
<div id="ref-sullivan16" class="csl-entry" role="listitem">
Sullivan, LaMorte, L. 2016. <span>“Comparing Survival Curves.”</span> <a href="https://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_survival/BS704_Survival5.html">sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_survival/BS704_Survival5.html</a>.
</div>
<div id="ref-zabor23" class="csl-entry" role="listitem">
Zabor, E. C. 2023. <span>“Survival Analysis in r.”</span> <a href="https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html">https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./HazardAnalysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Cox Proportional Hazards Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>